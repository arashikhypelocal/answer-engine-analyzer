<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="utf-8" />
  <title>Answer Engine Analyzer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- Inter font (clean, modern) -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind CDN (no build step) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'ui-sans-serif', 'system-ui', 'Segoe UI', 'Roboto', 'Arial', 'sans-serif'] },
          colors: {
            brand: { DEFAULT: '#06b6d4', 50:'#ecfeff', 100:'#cffafe', 200:'#a5f3fc', 300:'#67e8f9', 400:'#22d3ee', 500:'#06b6d4', 600:'#0891b2', 700:'#0e7490', 800:'#155e75', 900:'#164e63' },
          },
          boxShadow: {
            card: '0 8px 30px rgba(2,6,23,.10)',
            cardHover: '0 12px 42px rgba(2,6,23,.16)',
            inset: 'inset 0 1px 0 rgba(255,255,255,.06)',
          }
        }
      }
    }
  </script>

  <!-- Minimal custom tokens + polish -->
  <link rel="stylesheet" href="styles.css" />
  <script defer src="app.js"></script>
</head>

<body class="h-full bg-surface text-ink transition-colors duration-300" data-theme="light">
  <!-- Gradient backdrop -->
  <div class="pointer-events-none fixed inset-0 -z-10 bg-grad"></div>

  <div class="max-w-6xl mx-auto px-4 sm:px-6 py-8">
    <!-- Header -->
    <header class="mb-8 flex items-center justify-between">
      <div>
        <h1 class="text-2xl sm:text-3xl font-semibold tracking-tight leading-tight">
          Answer Engine Analyzer
        </h1>
        <p class="text-sub/90 text-sm mt-1">Everything runs in your browser â€” fast, private, reliable.</p>
      </div>

      <!-- Theme toggle -->
      <button id="themeToggle"
              class="group inline-flex items-center gap-2 rounded-xl border px-3 py-2 text-sm font-medium
                     border-edge bg-panel hover:bg-panelHover shadow-sm transition-colors"
              aria-label="Toggle theme">
        <span id="themeIcon">ðŸŒž</span>
        <span id="themeLabel">Light</span>
      </button>
    </header>

    <!-- Grid -->
    <main class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Card: Input -->
      <section class="card">
        <div class="card-hd">
          <h2 class="card-title">1) Provide Input</h2>
        </div>
        <div class="space-y-4">
          <div>
            <label class="lbl">Upload .txt</label>
            <input id="fileInput" type="file" accept=".txt" class="input file-input">
          </div>
          <div>
            <label class="lbl">Or paste raw text</label>
            <textarea id="pasteArea" class="textarea" placeholder='{
  "title": "Best Calgary Roofing Companies",
  "create_time": 1755790426.905536,
  "update_time": 1755790438.622881,
  "mapping": {
    "title": "Example",
    "url": "https://example.com"
  }
}'></textarea>
          </div>

          <div class="flex flex-wrap items-center gap-3">
            <button id="runExtract" class="btn btn-primary">Run Extraction</button>
            <button id="resetBtn" class="btn btn-ghost">Reset</button>
            <span id="inputInfo" class="badge">no input loaded</span>
          </div>

          <div id="extractStatus" class="text-sub text-sm"></div>
        </div>
      </section>

      <!-- Card: Extracted Preview & Download -->
      <section class="card">
        <div class="card-hd">
          <h2 class="card-title">2) Extracted Output</h2>
        </div>
        <div class="space-y-4">
          <div class="flex flex-wrap gap-3">
            <button id="dlExtracted" class="btn btn-ghost">Download extracted.txt</button>
          </div>

          <details class="grp">
            <summary class="summary">Preview (first 2000 chars)</summary>
            <pre id="extractedPreview" class="pre"></pre>
          </details>
        </div>
      </section>

      <!-- Card: N-grams Config -->
      <section class="card lg:col-span-2">
        <div class="card-hd">
          <h2 class="card-title">3) N-grams (from extracted content only â€” excludes URLs)</h2>
        </div>

        <div class="flex flex-wrap items-end gap-4 mb-4">
          <label class="lbl-sm">
            <span>Top K</span>
            <input id="topK" type="number" min="1" value="50" class="input w-28">
          </label>
          <label class="lbl-sm">
            <span>Min Freq</span>
            <input id="minFreq" type="number" min="1" value="1" class="input w-28">
          </label>
          <label class="lbl-sm grow">
            <span>Extra stopwords (comma)</span>
            <input id="extraStop" type="text" placeholder="dxp,cms" class="input w-full">
          </label>
          <label class="lbl-sm grow">
            <span>Blacklist tokens (comma)</span>
            <input id="extraBlack" type="text" placeholder="title,snippet" class="input w-full">
          </label>

          <button id="runNgrams" class="btn btn-primary shrink-0">Run N-grams</button>
        </div>

        <div class="flex flex-wrap gap-3 mb-2">
          <button id="dlBi" class="btn btn-ghost">bigrams.csv</button>
          <button id="dlTri" class="btn btn-ghost">trigrams.csv</button>
          <button id="dlFour" class="btn btn-ghost">fourgrams.csv</button>
        </div>

        <div id="ngStatus" class="text-sub text-sm mb-4"></div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- Bigrams -->
          <div class="table-card">
            <div class="table-hd">Bigrams</div>
            <div class="table-wrap">
              <table class="tbl">
                <thead><tr><th>phrase</th><th>freq</th></tr></thead>
                <tbody id="tblBi"></tbody>
              </table>
            </div>
          </div>

          <!-- Trigrams -->
          <div class="table-card">
            <div class="table-hd">Trigrams</div>
            <div class="table-wrap">
              <table class="tbl">
                <thead><tr><th>phrase</th><th>freq</th></tr></thead>
                <tbody id="tblTri"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Fourgrams -->
        <div class="table-card mt-6">
          <div class="table-hd">4-grams</div>
          <div class="table-wrap">
            <table class="tbl">
              <thead><tr><th>phrase</th><th>freq</th></tr></thead>
              <tbody id="tblFour"></tbody>
            </table>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="mt-10 text-center text-xs text-sub/80">
      Built with care â€¢ <span class="text-brand-600">Fast, accessible, robust</span>
    </footer>
  </div>

  <!-- Toasts -->
  <div id="toast" class="toast hidden"></div>
</body>
</html>
